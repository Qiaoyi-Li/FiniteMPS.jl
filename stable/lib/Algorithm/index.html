<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Algorithms · FiniteMPS.jl</title><meta name="title" content="Algorithms · FiniteMPS.jl"/><meta property="og:title" content="Algorithms · FiniteMPS.jl"/><meta property="twitter:title" content="Algorithms · FiniteMPS.jl"/><meta name="description" content="Documentation for FiniteMPS.jl."/><meta property="og:description" content="Documentation for FiniteMPS.jl."/><meta property="twitter:description" content="Documentation for FiniteMPS.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">FiniteMPS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../../tutorial/Threading/">Multi-threading</a></li><li><a class="tocitem" href="../../tutorial/Hamiltonian/">Hamiltonian</a></li><li><a class="tocitem" href="../../tutorial/Observable/">Observable</a></li><li><a class="tocitem" href="../../tutorial/Heisenberg/">Heisenberg Chain</a></li><li><a class="tocitem" href="../../tutorial/Hubbard/">Hubbard Model</a></li></ul></li><li><span class="tocitem">Local Space</span><ul><li><a class="tocitem" href="../../localspace/Spin/">Spin</a></li><li><a class="tocitem" href="../../localspace/Fermion/">Fermion</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../TensorWrappers/">Tensor Wrappers</a></li><li><a class="tocitem" href="../MPS/">MPS &amp; MPO</a></li><li><a class="tocitem" href="../Environment/">Environment</a></li><li><a class="tocitem" href="../ProjHam/">Projective Hamiltonian</a></li><li><a class="tocitem" href="../IntrTree/">Interaction Tree</a></li><li><a class="tocitem" href="../ObsTree/">Observable Tree</a></li><li><a class="tocitem" href="../ITP/">Imaginary Time Proxy</a></li><li><a class="tocitem" href="../Algebra/">MPS &amp; MPO Algebra</a></li><li class="is-active"><a class="tocitem" href>Algorithms</a><ul class="internal"><li><a class="tocitem" href="#DMRG"><span>DMRG</span></a></li><li><a class="tocitem" href="#TDVP"><span>TDVP</span></a></li><li><a class="tocitem" href="#SETTN"><span>SETTN</span></a></li><li><a class="tocitem" href="#CBE"><span>CBE</span></a></li></ul></li><li><a class="tocitem" href="../Deprecate/">Deprecate</a></li></ul></li><li><span class="tocitem">Index</span><ul><li><a class="tocitem" href="../../index/">Index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href>Algorithms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Algorithms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/main/docs/src/lib/Algorithm.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Algorithms"><a class="docs-heading-anchor" href="#Algorithms">Algorithms</a><a id="Algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithms" title="Permalink"></a></h1><p>Some high level algorithms based on MPS and MPO.</p><h2 id="DMRG"><a class="docs-heading-anchor" href="#DMRG">DMRG</a><a id="DMRG-1"></a><a class="docs-heading-anchor-permalink" href="#DMRG" title="Permalink"></a></h2><p>Density matrix renormalization group.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.BondInfo" href="#FiniteMPS.BondInfo"><code>FiniteMPS.BondInfo</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct BondInfo
      D::Int64
      DD::Int64
      TrunErr::Float64
      SE::Float64
 end</code></pre><p>Type for storing the information of a bond.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs"> BondInfo(s::AbstractTensorMap, ϵ::Float64 = 0.0)</code></pre><p>Outer constructor via giving the <code>s</code> tensor and <code>ϵ</code> form <code>tsvd</code>.</p><pre><code class="nohighlight hljs"> BondInfo(A::AbstractTensorMap, direction::Symbol)
 BondInfo(A::MPSTensor, direction::Symbol)</code></pre><p>Outer constructor via giving a tensor <code>A</code> and <code>direction = :L</code> or <code>:R</code>. We cannot get truncation error and singular values hence <code>TrunErr</code> and <code>SE</code> are set to <code>0.0</code> and <code>NaN</code>, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/Info.jl#L26-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.DMRGInfo" href="#FiniteMPS.DMRGInfo"><code>FiniteMPS.DMRGInfo</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct DMRGInfo
      Eg::Float64
      Lanczos::LanczosInfo
      Bond::BondInfo
 end</code></pre><p>Information of each DMRG update.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/Info.jl#L109-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.LanczosGS" href="#FiniteMPS.LanczosGS"><code>FiniteMPS.LanczosGS</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LanczosGS(f::Function, x₀, args...;
	K::Int64 = 32,
	tol::Real = 1e-8,
	callback::Union{Nothing, Function} = nothing,
	verbose = false
) -&gt; ϵg::Number, xg::AbstractVector, info::Dict{Symbol, Any}</code></pre><p>Solve the ground state problem for a hermitian map <code>x -&gt; f(x, args...)</code> using the Lanczos algorithm. <code>f</code> can be any function as if it acts on <code>x</code> like an hermitian operator and preserves the type of <code>x</code>.</p><p><strong>Required methods</strong></p><p><code>x</code> can be any type as if it behaves like a vector in Hilbert space, i.e. the following methods are implemented:</p><pre><code class="nohighlight hljs">normalize!(x)</code></pre><p>In-place normalize <code>x</code> according to the inner-induced norm.</p><pre><code class="nohighlight hljs">norm(x)</code></pre><p>Return the inner-induced norm.</p><pre><code class="nohighlight hljs">inner(x, y)</code></pre><p>Return the inner product <code>⟨x, y⟩</code>.</p><pre><code class="nohighlight hljs">add!(y, x, α)</code></pre><p>In-place add <code>y -&gt; y + αx</code>.</p><pre><code class="nohighlight hljs">rmul!(x, α)</code></pre><p>In-place multiply <code>x -&gt; αx</code>.</p><p><strong>Kwargs</strong></p><pre><code class="nohighlight hljs">K::Int64 = 32</code></pre><p>Krylov space dimension.</p><pre><code class="nohighlight hljs">tol::Real = 1e-8</code></pre><p>Convergence tolerance.  </p><pre><code class="nohighlight hljs">callback::Union{Nothing, Function} = nothing</code></pre><p>A in-placed callback function, applied to x after each iteration.</p><pre><code class="nohighlight hljs">verbose::Bool = false</code></pre><p>If <code>true</code>, print convergence information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/Lanczos/LanczosGS.jl#L1-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.DMRGSweep2!" href="#FiniteMPS.DMRGSweep2!"><code>FiniteMPS.DMRGSweep2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> DMRGSweep2!(Env::SparseEnvironment{L,3,T}, ::SweepDirection; kwargs...) 
      -&gt; info::Vector{DMRGInfo}, Timer::TimerOutput</code></pre><p>2-site DMRG sweep from left to right or sweep back from right to left.  </p><p><strong>Kwargs</strong></p><pre><code class="nohighlight hljs"> K::Int64 = 16</code></pre><p>Krylov space dimension.</p><pre><code class="nohighlight hljs"> tol::Real = 1e-8</code></pre><p>Tolerance for eagerly break in Lanczos iteration.</p><pre><code class="nohighlight hljs"> trunc::TruncationScheme = truncbelow(MPSDefault.tol) &amp; truncdim(MPSDefault.D)</code></pre><p>Control the truncation in svd after each 2-site update. Details see <code>tsvd</code>. </p><pre><code class="nohighlight hljs"> GCstep::Bool = false</code></pre><p><code>GC.gc()</code> manually after each step if <code>true</code>.</p><pre><code class="nohighlight hljs"> GCsweep::Bool = false</code></pre><p><code>GC.gc()</code> manually after each (left to right or right to left) sweep if <code>true</code>.  </p><pre><code class="nohighlight hljs"> verbose::Int64 = 0</code></pre><p>Print the <code>TimerOutput</code> after each sweep or each local update if <code>verbose = 1</code> or <code>2</code>, respectively.</p><pre><code class="nohighlight hljs"> noise::Real = 0</code></pre><p>Add noise to the 2-site local tensor after each update via applying a random gate to the physical indices. Note this is only a naive implementation, and may not work well for some cases. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/DMRG.jl#L1-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.DMRGSweep1!" href="#FiniteMPS.DMRGSweep1!"><code>FiniteMPS.DMRGSweep1!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> DMRGSweep1!(Env::SparseEnvironment{L,3,T}, ::SweepDirection; kwargs...)
      -&gt; info::Vector{DMRGInfo}, Timer::TimerOutput</code></pre><p>1-site DMRG sweep from left to right or sweep back from right to left.  </p><p><strong>Kwargs</strong></p><pre><code class="nohighlight hljs"> K::Int64 = 16</code></pre><p>Krylov space dimension.</p><pre><code class="nohighlight hljs"> tol::Real = 1e-8</code></pre><p>Tolerance for eagerly break in Lanczos iteration.</p><pre><code class="nohighlight hljs"> GCstep::Bool = false</code></pre><p><code>GC.gc()</code> manually after each step if <code>true</code>.</p><pre><code class="nohighlight hljs"> GCsweep::Bool = false</code></pre><p><code>GC.gc()</code> manually after each (left to right or right to left) sweep if <code>true</code>.   </p><pre><code class="nohighlight hljs"> verbose::Int64 = 0</code></pre><p>Print the <code>TimerOutput</code> after each sweep or each local update if <code>verbose = 1</code> or <code>2</code>, respectively.</p><pre><code class="nohighlight hljs"> CBEAlg::CBEAlgorithm = NoCBE()</code></pre><p>CBE algorithm for 1-DMRG.</p><pre><code class="nohighlight hljs"> trunc::TruncationScheme = notrunc()</code></pre><p>Control the truncation after each update, only used together with CBE. Details see <code>tsvd</code>. </p><pre><code class="nohighlight hljs"> noise::NTuple{2, Float64} = (0.1, 0.0)</code></pre><p>Add noise to the 1-site local tensor after each Lanczos update via expanding the bond and add a random tensor (normal distribution) to it. The first element is the ratio of additional bond dimension <code>(≤ 1.0)</code>, the second element is the noise strength.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/DMRG.jl#L159-L189">source</a></section></article><h2 id="TDVP"><a class="docs-heading-anchor" href="#TDVP">TDVP</a><a id="TDVP-1"></a><a class="docs-heading-anchor-permalink" href="#TDVP" title="Permalink"></a></h2><p>Time-dependent variational principle for both MPS and MPO (viewed as a MPS via Choi isomorphism).</p><p>Note the local projective Hamiltonian action in <code>TDVPSweep2!</code> has not been updated to newest implementation. Using 1-TDVP equipped with controlled bond expansion (CBE) is preferred. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.TDVPInfo" href="#FiniteMPS.TDVPInfo"><code>FiniteMPS.TDVPInfo</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct TDVPInfo{N,T}
      dt::T
      Lanczos::LanczosInfo
      Bond::BondInfo
 end</code></pre><p>Information of each <code>N</code>-site TDVP update.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs"> TDVPInfo{N}(dt::Number, Lanczos::LanczosInfo, Bond::BondInfo)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/Info.jl#L127-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.LanczosExp" href="#FiniteMPS.LanczosExp"><code>FiniteMPS.LanczosExp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LanczosExp(f::Function, x₀, t::Number, args...;
	K::Int64 = 32,
	tol::Real = 1e-8,
	callback::Union{Nothing, Function} = nothing,
	verbose = false
) -&gt; exp(At)*x, info::Dict{Symbol, Any}</code></pre><p>Compute <code>exp(At)x₀</code> for a hermitian map <code>A: x -&gt; f(x, args...)</code> using the Lanczos algorithm. <code>f</code> can be any function as if it acts on <code>x</code> like an hermitian operator and preserves the type of <code>x</code>.</p><p><strong>Required methods</strong></p><p><code>x</code> can be any type as if it behaves like a vector in Hilbert space, i.e. the following methods are implemented:</p><pre><code class="nohighlight hljs">eltype(x)</code></pre><p>Return the element type of <code>x</code>, e.g. <code>Float64</code> or <code>ComplexF64</code>.</p><pre><code class="nohighlight hljs">normalize!(x)</code></pre><p>In-place normalize <code>x</code> according to the inner-induced norm.</p><pre><code class="nohighlight hljs">norm(x)</code></pre><p>Return the inner-induced norm.</p><pre><code class="nohighlight hljs">inner(x, y)</code></pre><p>Return the inner product <code>⟨x, y⟩</code>.</p><pre><code class="nohighlight hljs">add!(y, x, α)</code></pre><p>In-place add <code>y -&gt; y + αx</code>.</p><pre><code class="nohighlight hljs">rmul!(x, α)</code></pre><p>In-place multiply <code>x -&gt; αx</code>.</p><p><strong>Kwargs</strong></p><pre><code class="nohighlight hljs">K::Int64 = 32</code></pre><p>Krylov space dimension.</p><pre><code class="nohighlight hljs">tol::Real = 1e-8</code></pre><p>Convergence tolerance.  </p><pre><code class="nohighlight hljs">callback::Union{Nothing, Function} = nothing</code></pre><p>A in-placed callback function, applied to x after each iteration.</p><pre><code class="nohighlight hljs">verbose::Bool = false</code></pre><p>If <code>true</code>, print convergence information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/Lanczos/LanczosExp.jl#L1-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.TDVPSweep2!" href="#FiniteMPS.TDVPSweep2!"><code>FiniteMPS.TDVPSweep2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> TDVPSweep2!(Env::SparseEnvironment{L,3,T},
      dt::Number,
      direction::SweepDirection;
      kwargs...) -&gt; info, TimerSweep</code></pre><p>Apply left-to-right or right-to-left 2-site TDVP<code>[https://doi.org/10.1103/PhysRevB.94.165116]</code> sweep to perform time evolution for <code>DenseMPS</code> (both MPS and MPO) with step length <code>dt</code>. <code>Env</code> is the 3-layer environment <code>⟨Ψ|H|Ψ⟩</code>.</p><pre><code class="nohighlight hljs"> TDVPSweep2!(Env::SparseEnvironment{L,3,T}, dt::Number; kwargs...)</code></pre><p>Wrap <code>TDVPSweep2!</code> with a symmetric integrator, i.e., sweeping from left to right and then from right to left with the same step length <code>dt / 2</code>.</p><p><strong>Kwargs</strong></p><pre><code class="nohighlight hljs"> krylovalg::KrylovKit.KrylovAlgorithm = TDVPDefaultLanczos
 trunc::TruncationType = truncbelow(MPSDefault.tol) &amp; truncdim(MPSDefault.D)
 GCstep::Bool = false
 GCsweep::Bool = false
 verbose::Int64 = 0
 E_shift::Float64 = 0.0</code></pre><p>Apply <code>exp(dt(H - E_shift))</code> to avoid possible <code>Inf</code> in imaginary time evolution. This energy shift is different from <code>E₀</code> in projective Hamiltonian, the later will give back the shifted energy thus not altering the final result. Note this is a temporary approach, we intend to store <code>log(norm)</code> in MPS to avoid this divergence in the future.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/TDVP/TDVP2.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.TDVPSweep1!" href="#FiniteMPS.TDVPSweep1!"><code>FiniteMPS.TDVPSweep1!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> TDVPSweep1!(Env::SparseEnvironment{L,3,T},
	  dt::Number,
	  direction::SweepDirection;
	  kwargs...) -&gt; info, TimerSweep</code></pre><p>Apply 1-site TDVP<code>[https://doi.org/10.1103/PhysRevB.94.165116]</code> sweep to perform time evolution for <code>DenseMPS</code> (both MPS and MPO) with step length <code>dt</code>. <code>Env</code> is the 3-layer environment <code>⟨Ψ|H|Ψ⟩</code>.</p><pre><code class="nohighlight hljs"> TDVPSweep1!(Env::SparseEnvironment{L,3,T}, dt::Number; kwargs...)</code></pre><p>Wrap <code>TDVPSweep1!</code> with a symmetric integrator, i.e., sweeping from left to right and then from right to left with the same step length <code>dt / 2</code>.</p><p><strong>Kwargs</strong></p><pre><code class="nohighlight hljs"> K::Int64 = 32 
 tol::Float64 = 1e-8</code></pre><p>The maximum Krylov dimension and tolerance in Lanczos exponential method.</p><pre><code class="nohighlight hljs"> trunc::TruncationType = notrunc()
 GCstep::Bool = false
 GCsweep::Bool = false
 verbose::Int64 = 0
 CBEAlg::CBEAlgorithm = NoCBE()
 E_shift::Float64 = 0.0</code></pre><p>Apply <code>exp(dt(H - E_shift))</code> to avoid possible <code>Inf</code> in imaginary time evolution. This energy shift is different from <code>E₀</code> in projective Hamiltonian, the later will give back the shifted energy thus not altering the final result. Note this is a temporary approach, we intend to store <code>log(norm)</code> in MPS to avoid this divergence in the future.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/TDVP/TDVP1.jl#L1-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.TDVPIntegrator" href="#FiniteMPS.TDVPIntegrator"><code>FiniteMPS.TDVPIntegrator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct TDVPIntegrator{N} 
      dt::NTuple{N, Float64}
      direction::NTuple{N, SweepDirection}
 end</code></pre><p>Type of TDVP integrators using composition methods. Note <code>dt</code> is relative, thus <code>sum(dt) == 1</code>.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs"> TDVPIntegrator(dt::NTuple{N, Rational}, direction::NTuple{N, SweepDirection})</code></pre><p>Standard constructor with checking <code>dt</code> and <code>direction</code>.</p><pre><code class="nohighlight hljs"> TDVPIntegrator(dt::Number...)</code></pre><p>Assume direction is repeated as L-R-L-R-..., thus <code>length(dt)</code> must be even.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/TDVP/Integrator.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.SymmetricIntegrator" href="#FiniteMPS.SymmetricIntegrator"><code>FiniteMPS.SymmetricIntegrator</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> SymmetricIntegrator(p::Int64) -&gt; TDVPIntegrator</code></pre><p>Construct predefined symmetric integrators with <code>p</code>-th order. Only <code>p = 2, 3, 4</code> are supported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/TDVP/Integrator.jl#L38-L42">source</a></section></article><h2 id="SETTN"><a class="docs-heading-anchor" href="#SETTN">SETTN</a><a id="SETTN-1"></a><a class="docs-heading-anchor-permalink" href="#SETTN" title="Permalink"></a></h2><p>Series-expansion thermal tensor network.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.SETTN" href="#FiniteMPS.SETTN"><code>FiniteMPS.SETTN</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> SETTN(H::SparseMPO, β::Number; kwargs...) -&gt; ρ::MPO, lsF::Vector{Float64}</code></pre><p>Use series-expansion thermal tensor network (SETTN)<code>[https://doi.org/10.1103/PhysRevB.95.161104]</code> method to initialize a high-temperature MPO <code>ρ = e^(-βH/2)</code>. Note <code>ρ</code> is unnormalized. The list of free energy <code>F = -lnTr[ρρ^†]/β</code> with different expansion orders is also returned.</p><p><strong>Kwargs</strong></p><pre><code class="nohighlight hljs"> trunc::TruncationScheme = truncdim(D) (this keyword argument is necessary!) 
 disk::Bool = false
 maxorder::Int64 = 4
 tol::Float64 = 1e-8
 bspace::VectorSpace (details please see identityMPO)
 compress::Float64 = 1e-16 (finally compress ρ with `tol = compress`)
 ρ₀::MPO (initial MPO, default = Id)</code></pre><p>Note we use <code>mul!</code> and <code>axpby!</code> to implement <code>H^n -&gt; H^(n+1)</code> and <code>ρ -&gt; ρ + (-βH/2)^n / n!</code>, respectively. All kwargs of these two functions are valid and will be propagated to them appropriately.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/SETTN.jl#L1-L16">source</a></section></article><h2 id="CBE"><a class="docs-heading-anchor" href="#CBE">CBE</a><a id="CBE-1"></a><a class="docs-heading-anchor-permalink" href="#CBE" title="Permalink"></a></h2><p>Controlled bond expansion (CBE). In the current version only a modified (based on rsvd, instead of shrewd selection) CBE is implemented, which is compatible with multi-threading.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.CBEAlgorithm" href="#FiniteMPS.CBEAlgorithm"><code>FiniteMPS.CBEAlgorithm</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> abstract type CBEAlgorithm{T &lt;: SweepDirection}</code></pre><p>Abstract type of all (controlled bond expansion) CBE algorithms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/CBE/CBEAlgorithm.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.NoCBE" href="#FiniteMPS.NoCBE"><code>FiniteMPS.NoCBE</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct NoCBE{T &lt;: SweepDirection} &lt;: CBEAlgorithm{T}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/CBE/CBEAlgorithm.jl#L8-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.FullCBE" href="#FiniteMPS.FullCBE"><code>FiniteMPS.FullCBE</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct FullCBE{T &lt;: SweepDirection} &lt;: CBEAlgorithm{T} 
      check::Bool
 end</code></pre><p>Special case of CBE algorithm, directly keep the full bond space, usually used near boundary.</p><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs"> FullCBE(direction::SweepDirection = AnyDirection(); check::Bool = false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/CBE/CBEAlgorithm.jl#L17-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.NaiveCBE" href="#FiniteMPS.NaiveCBE"><code>FiniteMPS.NaiveCBE</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct NaiveCBE{T&lt;:SweepDirection} &lt;: CBEAlgorithm{T}
      D::Int64
      tol::Float64
      rsvd::Bool
      check::Bool
 end</code></pre><p>An naive implementation of CBE, where we directly contract the 2-site environment and then perform svd. Note the svd is O(D^3d^3) or O(D^3d^6) for MPS or MPO, respectively, which becomes the bottleneck of the algorithm. Therefore, a random svd is used to reduce the svd cost to O(D^3d) or O(D^3d^2).  </p><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs"> NaiveCBE(D::Int64,
      tol::Float64,
      direction::SweepDirection = AnyDirection();
      rsvd::Bool = false,
      check::Bool = false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/CBE/CBEAlgorithm.jl#L34-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.CBEInfo" href="#FiniteMPS.CBEInfo"><code>FiniteMPS.CBEInfo</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct CBEInfo{N}
      Alg::CBEAlgorithm
      info::NTuple{N, BondInfo}
      D₀::NTuple{2, Int64}
      D::NTuple{2, Int64}
      ϵp::Float64
      ϵ::Float64
 end</code></pre><p>Information of CBE. <code>Alg</code> is the algorithm used. <code>info</code> contain the truncation info of <code>N</code> times svd. <code>D₀</code> and <code>D</code> are the initial and final bond dimension, respectively. <code>ϵp</code> is the estimated projection error. <code>ϵ = |Al*Ar - Al_ex*Ar_ex|</code> if calculated (otherwise <code>NaN</code>). </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/CBE/CBEAlgorithm.jl#L76-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.CBE" href="#FiniteMPS.CBE"><code>FiniteMPS.CBE</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> CBE(Al::MPSTensor, Ar::MPSTensor,
	  El::SparseLeftTensor, Er::SparseRightTensor,
	  Hl::SparseMPOTensor, Hr::SparseMPOTensor,
	  Alg::CBEAlgorithm
	  ) -&gt; Al_ex::MPSTensor, Ar_ex::MPSTensor, info::CBEInfo, TO::TimerOutput</code></pre><p>Return the two expanded local tensors <code>Al_ex</code> and <code>Ar_ex</code> after CBE.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/CBE/CBE.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.LeftOrthComplement" href="#FiniteMPS.LeftOrthComplement"><code>FiniteMPS.LeftOrthComplement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct LeftOrthComplement{N}
	El::Vector{AbstractTensorMap}
	Al::Vector{AbstractTensorMap}
	Al_c::AbstractTensorMap
end</code></pre><p>A concrete type to deal with the left half of the orthogonal complement projector of 1-site tangent space in the 2-site variational space.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">LeftOrthComplement(El_i::SparseLeftTensor,
	Al_c::MPSTensor{R},
	Hl::SparseMPOTensor,
	Al_i::MPSTensor = Al_c)</code></pre><p>Construct the object via providing the initial left environment tensor <code>El_i</code>, the left canonical MPS tensor <code>Al_c</code>, the Hamiltonian MPO tensor <code>Hl</code>, and the initial local tensor at the left site. The initialization process will automatically generate the temporary tensors <code>El</code> and <code>Al</code> that are used in the CBE algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/CBE/OrthComplement.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteMPS.RightOrthComplement" href="#FiniteMPS.RightOrthComplement"><code>FiniteMPS.RightOrthComplement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct RightOrthComplement{N}
	Er::Vector{AbstractTensorMap}
	Ar::Vector{AbstractTensorMap}
	Ar_c::AbstractTensorMap
end</code></pre><p>A concrete type to deal with the right half of the orthogonal complement projector of 1-site tangent space in the 2-site variational space.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">RightOrthComplement(Er_i::SparseRightTensor,
	Ar_c::MPSTensor{R},
	Hr::SparseMPOTensor,
	Ar_i::MPSTensor{R} = Ar_c)</code></pre><p>Construct the object via providing the initial right environment tensor <code>Er_i</code>, the right canonical MPS tensor <code>Ar_c</code>, the Hamiltonian MPO tensor <code>Hr</code>, and the initial local tensor at the right site. The initialization process will automatically generate the temporary tensors <code>Er</code> and <code>Ar</code> that are used in the CBE algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteMPS.jl/blob/7e49c7c7957e1bff2c76703554052bb810ca6a05/src/Algorithm/CBE/OrthComplement.jl#L38-L53">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Algebra/">« MPS &amp; MPO Algebra</a><a class="docs-footer-nextpage" href="../Deprecate/">Deprecate »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 31 July 2025 10:27">Thursday 31 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
